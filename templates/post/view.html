{% extends "layouts/split.html" %}

{% block head -%}
{{ super() }}
{% include "includes/editor.html" %}
{%- endblock %}

{% block title %}{{ post.title|e }}{% endblock %}
{% block main -%}
<div id="post">
    <div class="list-header">
        <h1>{{ post.title|e }}</h1>
    </div>
    <div class="main body">
        {{ post_body|safe }}
    </div>
</div>
<hr class="big">
<div id="responses">
    <div class="list-header">
        <h2>Answers</h2>
    </div>
    {% if answers.pages == 0 -%}
    <div class="response-empty">No answers posted</div>
    {%- elif answers.items|length == 0 -%}
    <div class="response-empty">No answers on page {{ answers.page }}</div>
    {%- else -%}
    <ul class="response-list">
        {% for answer in answers.items %}
            <div class="answer" data-id="{{ answer.id|e }}">
                <div class="header">
                    <img src="{{ answer.get_language().get_logo_url() }}">
                    <h4>{{ answer.get_language().get_display_name() }}</h4>

                    <div class="answer-metric">
                        {{ answer.code|length }}<span>bytes</span>
                    </div>
                </div>
                <div class="body">
                    {{ macros.highlight_answer(answer)|safe }}
                </div>
            </div>
        {% endfor %}
        <div class="pagination">
            {% if answers.has_prev -%}
                <a href="?p={{ answers.page - 1 }}" class="page-ctrl -before active">
            {%- else -%}
                <a class="page-ctrl -before">
            {%- endif %}
                {% include "svg/left-caret.html" %} Prev
            </a>
            <div class="page-list -before">
                {% for num in macros.pages_below(answers) %}
                <a href="?p={{ num }}">{{ num }}</a>
                {% endfor %}
            </div>
            <form method="GET" action="{{ request.path|e }}">
                <input class="current-page input-type -num" value="{{ answers.page|e }}" name="p" type='text'>
            </form>
            <div class="page-list -after">
                {% for num in macros.pages_above(answers) %}
                <a href="?p={{ num }}">{{ num }}</a>
                {% endfor %}
            </div>
            {% if answers.has_next -%}
                <a href="?p={{ answers.page + 1 }}" class="page-ctrl -after active">
            {%- else -%}
                <a class="page-ctrl -after">
            {%- endif %}
                Next {% include "svg/right-caret.html" %}
            </a>
        </div>
    </ul>
    {%- endif %}
</div>
{%- endblock %}

{% block sidebar -%}
<div class="content-sidebar fixed-aside">
    {% if g.user is not none -%}
    <a id="write-answer" class="button accent -center">
        {% include "svg/pen.html" %}
        Write answer
    </a>
    {%- endif %}
    <div class="csb-section">
        <h3>Leaderboard</h3>
        <table class="leaderboard">
            <tr>
                <td class="counter">1.</td>
                <td class="item-id">
                    <img class="icon" src="/static/lang/js.svg"/>
                    <span class="item-anchor">
                        <a>JavaScript</a>
                        <span class="author">by <span>Downgoat</span></span>
                    </span>
                </td>
                <td>
                    6<span class="label-type">bytes</span>
                </td>
            </tr>
            <tr>
                <td class="counter">2.</td>
                <td class="item-id">
                    <img class="icon" src="/static/lang/py.svg"/>
                    <span class="item-anchor">
                        <a>Python</a>
                        <span class="author">by <span>Evil Sheep</span></span>
                    </span>
                </td>
                <td>
                    8<span class="label-type">bytes</span>
                </td>
            </tr>
        </table>
    </div>
</div>
{%- endblock %}

{% block body %}
{{ super() }}
{% include "includes/answer-box.html" %}
{% endblock %}
